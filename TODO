* tests and coverage

* make reset headers on error configurable

* websockets
